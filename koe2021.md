---
layout: page
title: Kokeen mallivastaukset ja arvosteluperusteet
inheader: no
permalink: /koe2021/
---

## Syksyn 2021 koe

### Teht√§v√§ 1

_Teht√§v√§n arvioi Riikka Korolainen. Omasta arvioinnista voi tarvittaessa kysy√§ etunimi.sukunimi@helsinki.fi tai discordissa_

Seuraavassa on joukko v√§itt√§mi√§ jotka saattavat olla totta tai v√§√§rin. Osa voi olla jopa yht√§aikaa totta ja ep√§totta. Kerro onko v√§itt√§m√§ totta vai/ja ep√§totta ja anna asialle lyhyt perustelu. 

**User story√§ ei ole pakko testata samassa sprintiss√§ miss√§ se toteutetaan**

Yleens√§ v√§√§ri: tulee toimia Definiton of donen puitteissa. Jos se m√§√§ritt√§√§ ett√§ testaus kuuluu valmiin kriteeriin, niin periaatteessa sillon story kuuluu testata samassa sprintiss√§ miss√§ se toteutetaan. Toteutetaan sprintiss√§ n ja testataan sprintiss√§ n+1 ei ainakaan ole kovin kosher-agilea. Jos mainitaan, ett√§ testaus voi menn√§ my√∂hemp√§√§n sprinttiin mutta t√§ll√∂in story ei tule edellisess√§ valmiiksi, t√§ydet pisteet. Jos mainittu, ett√§ DoD ilman testivaatimuksia tarkoittaa, ettei testej√§ ole pakko tehd√§, ei miinusta, ellei j√§tet√§ erikseen mainitsematta, ett√§ t√§m√§ on harvinaista. Esim oikein: voidaan m√§√§ritell√§ DoD niin, ettei testej√§ tarvitse tehd√§, ja erityistapauksena vaaditaan testaamista, 0.25p.

**Product owner m√§√§ritt√§√§ user storyjen ty√∂m√§√§r√§arviot**

V√§√§rin: ty√∂m√§√§raarviot m√§√§rittelee kehitt√§j√§tiimi. Jos mainittu, ett√§ PO tekee jonkin verran yhteisty√∂t√§/auttaa estimoinnissa, ei miinusta: tavallaanhan PO kertoo, mit√§ story pit√§√§ sis√§ll√§√§n, mik√§ vaikuttaa estimointiin.

**Sprint backlogin teht√§ville on pakko antaa ty√∂m√§√§r√§arviot**

V√§√§rin: esim. scrum suositteleen backlogilla olevien t√∂iden ty√∂m√§√§r√§n arviointia mutta ei ota suoraan kantaa sprint backlogin teht√§vien ty√∂m√§√§rien arviointiin vaikka vihjaakin siihen suuntaan esim. sprinttien burndownkaaviolla. Uusin Scrum-kirjallisuus kyseenalaistaa sprint-backlogin estimoinnin j√§rkevyyden. Jos vastaus on ‚Äúoikein‚Äù ja perustellaan, ett√§ taskit on estimoitava jotta burndownia voidaan yll√§pit√§√§/ j√§ljell√§ olevaa ty√∂m√§√§r√§√§ arvioida, 0.5 pistett√§.

**Firman paras kehitystiimi saadaan selville vertailemalla tiimien velositeettia**

V√§√§rin sik√§li ett√§ (yleens√§) storypointeissa mitattava velositeetti on suhteellinen ja suoranaisesti ei rinnastu mihink√§√§n varsinaiseen ty√∂m√§√§r√§√§n. Kukin tiimi yleens√§ estimoi itse ja storypointien m√§√§r√§ll√§ ei ole yhteismitallisuutta. T√§h√§n poikkeuksena toki tilanne, miss√§ useampi tiimi ty√∂skenelee saman backlogin parissa ja estimoi yhdess√§. T√§ll√§isess√§ tilanteessa jonkinlaista yhteismitallisuutta saattaisi olla. T√§ss√§ t√§ydet vain jos story pointteihin on (ainakin ep√§suorasti) viitattu. Jos puhutaan ainoastaan eroista storyjen m√§√§riss√§, 0.25p. Muu selitys esim. vertailu on ik√§v√§√§ ja luo huonoa henke√§, 0-0.25p perustelusta riippuen.

**Ketteri√§ menetelmi√§ k√§ytett√§ess√§ ohjelmiston arkkitehtuuri suunnitellaan aina ensimm√§isen sprintin aikana**


V√§√§rin: alustava arkkitehtuuri hahmotellaan yleens√§ alussa, joskus ensimm√§isess√§ sprintiss√§, joskus ns nollasprintiss√§. Ketter√§t menetelm√§t kuitenkin suosivat inkrementaalista arkkitehtuuria, miss√§ arkkitehtuuri voi tarkentua ja jopa muuttua my√∂hempienkin sprinttien aikana. T√§m√§ on tulkittavissa my√∂s oikeaksi mik√§li perustellaan, ett√§ arkkitehtuurin suunnittelua tehd√§√§n kyll√§ jonkin verran ensimm√§isess√§ sprintiss√§ ja sit√§ tarkennetaan my√∂hemmin.

**A/B-testaus on er√§s tuotannossa tapahtuvan testauksen muoto**

V√§√§rin sik√§li ett√§ A/B-testaus, vaikka se tapahtuukin tuotannossa, ei suoranaisesti ole testauksen menetelm√§ vaan toiminnallisuuksien k√§ytt√∂kelpoisuuden validointimenetelm√§. A/B-testaus kyll√§kin toteutetaan usein ns. feature-flageilla joita my√∂s k√§ytet√§√§n tuotannossa tapahtuvaan testaukseen. Jos on laitettu oikein ja perustellaan kuten t√§ss√§, 0.5 pistett√§ (testauksen m√§√§ritelm√§ on k√§sitetty sis√§lt√§m√§√§n k√§ytt√∂kelpoisuuden validointi). Jos on laitettu oikein ja perustellaan, ett√§ A/B-testauksella mitataan, toimiiko ominaisuus ja A/B-testauksen menetelm√§ on kuvattu oikein, 0.25 pistett√§.

**Arviointi:**

- 0 pistett√§ jos vastauksessa ei mit√§√§n oikeita perusteita
- 0.25 pistett√§ jos vastauksessa pieni√§ virheit√§ tai huono perustelu
- 0.5 pistett√§ jos vastaus on perusteltu hyvin. 
- Mallissa v√§√§rin mutta oikein perustellusti vastauksessa oikeaksi merkitty voi olla 0,5 pisteen arvoinen. Lis√§ksi ihan kaikkea, mik√§ mallista l√∂ytyy, ei tarvitse olla mainittuna.

### Teht√§v√§ 2

_Teht√§v√§n arvioi Antti Kantola. Omasta arvioinnista voi tarvittaessa kysy√§ etunimi.sukunimi@helsinki.fi tai discordissa_

User story kuvaa asiakkaan kannalta arvoa tuottavan toiminnallisuuden ja sis√§lt√§√§ lyhyen tekstuaalisen kuvauksen lis√§ksi joukon hyv√§ksym√§kriteerej√§ (+ lupauksen siit√§ ett√§ storyn sis√§lt√∂ neuvotellaan/tarkennetaan asiakkaan kanssa).  Hyv√§ noudataa lis√§ksi INVEST-kriteerist√∂√§. Hyv√§ backlog taas noudattaa DEEP-kriteerist√∂√§.

Ainoa story on liian iso (ei S), se sis√§lt√§√§ osin teknist√§ jargonia (ei kokonaisuudessaan V), sen testattavuus on heikko (ei T) ja luonnollisesti hyv√§ksym√§kriteerit puuttuvat storylt√§ kokonaisuudessaan. Storylt√§ puuttuu my√∂s ty√∂m√§√§r√§arvio (ei E).

DEEP-kriteerist√∂n hengess√§ story tulee pilkkoa pienemmiksi, estimoiduiksi ja priorisoiduiksi storyiksi. Korkean prioriteetin storyt tulee olla tarkemmin m√§√§ritellyt ja niill√§ tulee olla hyv√§ksym√§kriteerit.


**Pisteytys: max 4p:**

-  +1,5p : User story INVEST kunkin kirjaimen ongelmallisuuden avaaminen +0,25 p / kirjain, pelkk√§ INVEST maininta tai kirjainten luettelu +0,25 p tai INVEST kirjainten avaaminen +0,5p
   - Independent: Sillisalatti, sis√§lt√§√§ monta eri toimintoa
   - Negotiable: Sis√§lt√§√§ asiakkaalle vierasta kielt√§, ottaa kantaa tekniseen toteutukseen.
   - Valuable: Sis√§lt√§√§ osittain teknist√§ jargonia
   - Estimable: Puuttuu ty√∂m√§√§r√§arvio
   - Small: Liian iso
   - Testable: Testattavuus on heikko

-  +1 p: Product backlog DEEP kunkin kirjaimen avaaminen teht√§v√§√§n vastaten, pelkk√§ maininta +0,25 p, pelkk√§ luettelo +0,5p
   - Detailed appropriately: Sopivan detaljoitu, korkean prioriteetin storyt pieni√§ ja hyv√§ksymiskriteerit selvill√§.
   - Estimated: Ty√∂m√§√§r√§ arviotu
   - Emergent: Kehkeytyv√§, muokattavissa tarpeen mukaan
   - Priorisoitu: Asetettu t√§rkeysj√§rjestykseen

-  +2 p: J√§rkev√§sti pilkotut user storyt +0,125 p / story (max +1,5 p)
   - 0 p: Liian laaja tai ep√§m√§√§r√§inen user story
   - -0,25 p: User storyss√§ teknist√§ jargonia (kuuluu sprint backlogille)
   - +0,5 p: Kysynt√§piikki on ei toiminnallinnen laatuvaatimus. Jos se halutaan user storyksi, niin se tulee muotoilla tyyliin:
      -  +0,5 p: ‚ÄúK√§ytt√§j√§n vasteaika saa olla korkeintaan ùë• millisekuntia 99 % tapauksista, kun sivulla on korkeintaan ùë¶ yht√§aikaista k√§ytt√§j√§√§‚Äù, miss√§ ùë•,ùë¶ ‚àà ‚Ñï
      -  Muuten 0 p

-  +1 p: Hyv√§ksymiskriteerit korkean prioriteetin user storyille.
   - +0,25 p / user story

-  -0,5 p: Ehdotettu, ett√§ product owner valitsee mitk√§ user storyt otetaan seuraavaan sprinttiin

Huomioita:
-   User storyt on hyv√§ t√§ss√§ tilanteessa kirjtata ‚ÄùK√§ytt√§j√§ voi‚Ä¶‚Äù, eik√§ k√§ytt√§√§ ‚ÄùAsiakas voi.., koska ‚Äùasiakas‚Äù on Copypizza.

### Teht√§v√§ 3

_Teht√§v√§n arvioi Touko Puro. Omasta arvioinnista voi tarvittaessa kysy√§ etunimi.sukunimi@helsinki.fi tai discordissa_

(1p) Ulkoinen laatu tarkoittaa kuinka sopiva k√§ytt√∂tarkoitukseensa ohjelmisto on eli pystyyk√∂ k√§ytt√§j√§ tekem√§√§n sill√§ haluamansa asiat.

(1p) Ohjelmiston validointi k√§ytt√§j√§n kanssa. Validoinnissa tarkistetaan, ett√§ ollaan tekem√§ss√§ asiakkaan tarpeita vastaavaa ohjelmistoa. Varmistetaan ett√§ m√§√§rittelydokumentit vastaavat asiakkaan tarpeita.

Ketter√§ss√§ ohjelmistotuotannossa validointi tapahtuu iteraatioiden lopussa demonstraatioiden kautta (Scrumissa Sprint Review). N√§in asiakas voi havaita jos kehitys ei etene haluttuun suuntaan, vaatimuksissa on jonkinlainen kommunikaatiovirhe ja jos h√§nen tarpeensa eiv√§t en√§√§ vastaa alkuper√§isi√§ vaatimuksia.

(1p) Automatisoidut testit ovat avainasemassa ulkoisen laadun varmistamisessa. T√§rkeimm√§t testityypit t√§h√§n liittyen on j√§rjestelm√§testaus, joka testaa j√§rjestelm√§√§ kokonaisuutena ja esimerkiksi tarkistaa, ett√§ Storyn toiminnallisuus on toteutettu oikein. Muut testityypit kuten regressio- ja yksikk√∂testit parantavat my√∂s ulkoista laatua, varsinkin jatkuvan integraation kanssa, eliminoiden mahdollisia bugeja. Testit auttavat ulkoista laatua eliminoimalla bugeja ja validoimalla ett√§ ohjelmisto t√§ytt√§√§ sen vaatimukset. 

(1p) Ketter√§n menetelmien testausk√§yt√§nteit√§. Jatkuva integraatio, TDD, ja acceptance test driven development kaikki pyrkiv√§t parantamaan ohjelmiston ulkoista laatua. Jatkuva integraatio eliminoi integraatio vaiheessa syntyvi√§ bugeja, TDD pyrkii edist√§m√§√§n koodin testattavuutta joka vuorostaan edist√§√§ v√§lillisesti sen ulkoista laatua ja acceptance test driven development varmistaa user storyjen toteutuksen oikeellisuuden. Leanin mukainen build quality in ja lyhyt aikav√§li valmiista testattuun kummatkin ovat ketteriin menetelmiin sis√§ltyvi√§ ominaisuuksia, jotka edist√§v√§t testausta ja ulkoista laatua. Tutkiva testaus auttaa ulkoista laatua l√∂yt√§m√§ll√§ virheit√§ joita automaattiset testit eiv√§t v√§ltt√§m√§tt√§ l√∂yt√§isi. Tuotannossa tapahtuva testaus esim blue-green-deployment tai canary release varmistavat ett√§ ohjelmisto toimii tuotantoymp√§rist√∂ss√§ halutulla tavalla.

### Teht√§v√§ 4

_Teht√§v√§n arvioi Antti Kantola. Omasta arvioinnista voi tarvittaessa kysy√§ etunimi.sukunimi@helsinki.fi tai discordissa_

Leanissa ideana on arvon nopea virtaalinen minimoiden aika asiakkaan tilauksesta valmiiseen, asiakkaalle toimitettuun tuotteeseen. Sykliaikaa minimoidaan poistamalla tuotantoketjusta siin√§ ilmenevi√§ arvoa tuottamattomia asioita eli hukkaa (muda, mura, muri), joista muda-tyyppisi√§ hukan muotoja Lean tunnistaa 7 kappaletta. 

Ty√∂skentelyss√§ 3 kuukauden sykli asettaa alarajan arvon virtaamiselle, asiakkaan on mahdotonta saada tilaamiaan featureita nopeampaa. Tiimijako taas aiheuttaa monenlaista hukkaa, joista fundamentaalein lienee tarpeeton siirtely. Toteutettavan ominaisuuden vaikutukset arkkitehtuuriin suunnittelee tiimi E, toteutuksesta tiimit A ja B, testauksen taas tekee tiimi D. Koodia j√§√§ my√∂s helposti v√§livarastoon esim odottamaan testausta. Samoin osa tiimeist√§ voi joutua odottamaan toisen tiimin aikaansaadosta (esim selainpuolen tiimi palelinpuolelle toteuettuja ominaisuuksia), tai tiimit saattavat toteuttaa jotain toiminnallisuuksia pit√§ksi aikaa ‚Äúv√§livarastoon‚Äù, odottamaan ett√§ toinen tiimi toteuttaa ominaisuuksiin oman vastuualueen osansa. Koska testaus suoritetaan erillisen tiimin toimesta, j√§√§ toteutettuihin ominaisuuksiin todenn√§k pitk√§ksi ajaksi bugeja

Uudistuksessa tiimeist√§ tulee tehd√§ cross functional ‚Äúfeature-tiimej√§‚Äù, jotka kukin toteuttavat kokonaisia asiakkaan tilaamia arvoa tuottavia toiminnallisuuksia. Kussakin uudessa tiimiss√§ tulee siis olla j√§seni√§ kutakuinkin jokaisesta vanhasta tiimist√§. Kehitysty√∂n iteraation pituus tulee valita mahdollisimman lyhyeksi tai kannattaa jopa toimia puhdasverisemm√§n pull-mallin mukaan ilman iteraatioita, siten ett√§ kukin tiimi valitsee yhteisen backlogin k√§rjest√§ sit√§ mukaa uusia storyj√§ kun tuotantokapasiteettia vapautuu. 

**Arvostelu:**


Monessa vastauksessa vastattiin ennemminkin kysymykseen ‚ÄùMit√§ on Lean?‚Äù, kun t√§ss√§ pyydettiin kertomaan mit√§ ongelmia Copypizzan kehitysty√∂ss√§ on ja miten se kannattaisi organisoida. Pelk√§st√§√§n Lean termien luettelu ei tuo pisteit√§. Vastaukset tulee perustella ja tulee vastata kysymyksiin.

Pisteytys +0,25 p / kohta, jollei toisin mainita.

Ongelmat (max 2 p)
   - Asiakkaalle arvon tuoton ongelmat  (max 0,75 p)
     - 3 kk sykli asettaa alarajan arvon virtaamiselle
     - Asiakas ei voi saada featureita nopeampaa
     -A siakas ei pysty vaikuttamaan ominaisuuksiin
   - Ty√∂n virtaavuuden ongelmat ja syntyv√§ hukka (max 1,5 p)
     - Muda, 7 l√§hdett√§ (max +1,25 p) pelkk√§ listan luettelu ei tuo pisteit√§, kohdat tulee perustella.
       -  Tarpeeton siirtely tiimilt√§ toiselle on suurin ongelma (+0,5 p)
       -  Ylituotanto ‚Äì ylim√§√§r√§iset ominaisuudet
       -  V√§livarastointi
       -  Liikaty√∂ ‚Äì turha dokumentointi tai testaaminen
       -  (Tarpeeton liikkuminen ‚Äì task switching)
       -  Odotus
       -  Viat
       -  Ihmisten potentiaalin alihy√∂dynt√§minen
     - Mura (max +0,25 p)
       - Kommunikaatio haasteet tiimien v√§lill√§
       - Ep√§s√§√§nn√∂llisyytt√§
     - Muri (max +0,25 p)
       - Ylikuormitus ja mahdottomat vaatimukset      

Ratkaisuja (max 2 p)
   - Lean filosofia, periaateet ja oppimisen tehostaminen (max 0,5 p)
     - Koko sovelluskehitys ja johto Lean koulutukseen
     - Ty√∂ntekij√∂iden arvostaminen
     - "Go see"
     - Lean on filosofia, ei pelk√§st√§√§n kokoelma kikkoja
     - Jatkuvan parantamisen mentaliteetti
     - Build ‚Äì measure ‚Äì learn -syklit
     - Kaizen-eventit <3 Retrot
     - Laatu ja testaus
   - Tiimien uudellen muodostaminen ja perustelut (max 0,5 p)
     - Cross functional "feature tiimej√§"
       - Otetaan yksi j√§sen tiimeist√§ A, B, C, E ja E ja perustetaan uudet tiimit. Tiimist√§ l√∂ytyy kaikkea osaamista, joten voi toteuttaa user storyn alusta loppuun. 0,5 p
       - Pelkk√§ maininta 0,25 p
     - Backend ja frontend -tiimit 0,25 p
     - Toiminnallisuuden mukaan (pitsan rakentaminen, tilauksen maksaminen, kamppanjakoodit, jne), koska viidelle tiimille t√§m√§ on siiloutumista. ( 0 p)
     - Yksi iso tiimi (-0,25 p)
     
   - Asiakkaalle enemm√§n arvoa (max 0,25 p)
     - Asiakkaan tapaaminen
       - koko tiimi tapaa asiakasta (0 p)
       - koko tiimi ei tapaa asikasta (-0,25 p)
     - Asiakkaan palveleminen mahdollisimman ‚Äùviime hetkell√§‚Äù (0,25 p)
   - Sykliajan lyhent√§minen ja perustelut (max 0,5 p)
     - Pull-systeemi, Jatkuva k√§ytt√∂√∂notto, sek√§ toteutus +0,5 p tai,
     - 1-2 viikon syklit (+0,25 p) tai,
     - 1 kuukauden sykli (0 p)
     - Perusteluja ja keinoja vastaukseen (0 p)
       - Kanbanin avulla
       - kukin tiimi valitsee yhteisen product backlogin k√§rjest√§ sit√§ mukaa uusia storyja, kun tuotantokapasiteettia vapautuu
       - JIT-tuotantomalli
       - P√§ivitt√§inen tuotantoon vienti
   - Tiimien toiminta yhdess√§ (max 0,25 p)
     - Yhteinen Product backlog
     - SAFe, LeSS tai DA
     - Scrum of Scrums

### Teht√§v√§ 5

_Teht√§v√§n arvioi Matti Luukkainen. Omasta arvioinnista voi tarvittaessa kysy√§ etunimi.sukunimi@helsinki.fi tai discordissa_

####  MitaÃà tarkoitetaan ohjelmiston sisaÃàisellaÃà laadulla? (1p)

Ohjelman sis√§isell√§ laadulla tarkoitetaan koodin sis√§isen rakenteen hyvyytt√§. Siihen vaikuttavia seikkoja ovat mm. koodin jatkokehityksen helppous, virheiden j√§ljityksen ja korjaamisen helppous ja kuinka vaivatonta koodin toiminnallisuuden oikeellisuus varmistaminen on muutoksia teht√§ess√§.

#### MitaÃà sisaÃàisen laadun kannalta ongelmallisia asioita esimerkkikoodissa on? (2p)

_Luokalla CopyPizza liikaa vastuita_. Tiedoston k√§sittely sek√§ eri formaatteihin eksporttaus tulee eriytt√§√§ omiin luokkiin. Tiedostonk√§sittely kannattaa injektoida, sille my√∂s tulee injektoida tiedoston nimi.

_Molemmat merkint√§metodit etsiv√§t id:n perusteella tilauksen_, logiikka kannattaa refaktoroida omaan metodiin.

_Listausmetodit sis√§lt√§v√§t toisteisen l√§pik√§yntilogiikan_. Voi refaktoroida esim. strategyn avulla

_Exporttauksesta huolehtiva metodi on koheesioltaan huono_, se tulee uudessa luokassa jakaa erikseen eri formaatit hoitaviin osiin, metodeihin tai jopa luokkiin. Eksportattavien tilausten valinta tulee hoitaa esim. listausmetodin generalisaation avulla.

_Tilauksen status s√§ilytet√§√§n nyt taikastringina_, kannattaa sensijaan k√§ytt√§√§ esim luokkamuuttujana m√§√§riteltyj√§ vakioita

_Asiakkan_ tiedot kannattaa eriytt√§√§ omaan luokkaan.

0.5p per kohta, paitsi kaksi viimeist√§ 0.25p per kohta. N√§iden lis√§ksi muista osuvista huomioista saattoi saada 0.25-0.5 pistett√§. Er√§s t√§ll√§inen oli huomautus id:n generointitavasta.

####  Selit√§ miten refaktoroisit alla olevan koodin soveltaen suunnittelumalleja tai muita tilanteeseen sopivia ratkaisuja (2p)

Yll√§ mainttujen kohtien korjaus, 0.5p per kohta, paitsi kaksi viimeist√§ 0.25p per kohta.

Alkuper√§inen koodi [t√§√§ll√§](https://github.com/mluukkai/copypizza)

Refaktoroitu versio:

```python
import random

class Customer:
    def __init__(self, name: str, address):
          self.name = name 
          self.address = address

    def __str__(self):
        return f'{self.name} {self.address}'

class Order:
    ORDERED = "ordered"
    DELIVERED = "delivered"
    MAKING = "making"

    def __init__(self, customer_name: str, customer_address: str, ingredients):
        self.status = Order.ORDERED
        self.customer = Customer(customer_name, customer_address)
        self.ingredints = ingredients

    def set_delivered(self):
        self.status = Order.DELIVERED

    def set_making(self):
        self.status = Order.MAKING

    def __str__(self):
        return f'{self.id} {self.status} {self.customer} {self.ingredints}'

class Repository:
    def __init__(self, file_name):  
        self.file_name = file_name

    def read(self):
        orders = []
        with open(self.file_name, "r") as file:
            for row in file:
                parts = row.strip().split(";")
                order = Order(parts[2], parts[3], parts[4].split(','))
                order.id = int(parts[0])
                order.status = parts[1]
                orders.append(order)
                
        return orders

    def save(self, orders):
        with open(self.file_name, "w") as file:
            for order in orders:
                ingredients = ','.join(order.ingredints)
                file.write(f'{order.id};{order.status};{order.customer.name};{order.customer.address};{ingredients}\n')

class CopyPizza:
    def __init__(self, repository):
        self._repository = repository
        self._orders = self._repository.read()

    def save(self):
        self._repository.save(self._orders)

    def _list_matching(self, matcher):
        return [order for order in self._orders if matcher(order)]

    def list_delivered(self):
        def order_delivered(order):
            return order.status == Order.DELIVERED

        return self._list_matching(order_delivered)

    def list_new(self):
        def order_new(order):
            return order.status == Order.ORDERED

        return self._list_matching(order_new)

    def list_customer(self, customer_name: str):
        def customer(order):
            return order.customer.name == customer_name

        return self._list_matching(customer)
  

    def list_ingredient(self, ingredient: str):
        def has_ingredient(order):
            return ingredient in order.ingredients

        return self._list_matching(has_ingredient)

    def _order_with_id(self, id: int):
        for order in self._orders:
            if order.id == id:
              return order 
        return None

    def mark_delivered(self, id: int):
        order = self._order_with_id(id)
        if not order:
            return
        order.set_delivered()

    def mark_making(self, id: int):
        order = self._order_with_id(id)
        if not order:
            return
        order.set_making()

    def take_order(self, order: Order):
        order.id = random.randint(1,10000000)
        self._orders.append(order)

    def export2(self, format: str, status: str):
        if format=='xml':
            print('<orders>')

        for order in self._orders:
            if format=='xml':
                if order.status == status:
                    print("  <order>")
                    print(f"    <id>{order.id}</id>")
                    print(f"    <customer><name>{order.customer.name}</name><address>{order.customer.address}</address></customer>")
                    print(f"    <numberOfIngredients>{len(order.ingredints)}</numberOfIngredients>")
                    print("  </order>")
            elif format=='tsv':
                if order.status == status:
                    print(f"{order.id}\t{order.customer.name}\t{order.customer.address}\t{len(order.ingredints)}")
            else:
              raise('unsupported format')

        if format=='xml':
          print('</orders>')

    def export(self, format: str, status: str):
        def has_status(order):
            return order.status == status

        orders_to_export = self._list_matching(has_status)
        Exporter(orders_to_export).export(format)

class Exporter:
    # nyt yhdell√§ eksportterioliolla voi hoitaa saman tilausjoukon eksportoinnin useisiin formaatteihin
    def __init__(self, orders):
        self._orders = orders
        
    def export_xml(self):
        print('<orders>')

        for order in self._orders:
          print("  <order>")
          print(f"    <id>{order.id}</id>")
          print(f"    <customer><name>{order.customer.name}</name><address>{order.customer.address}</address></customer>")
          print(f"    <numberOfIngredients>{len(order.ingredints)}</numberOfIngredients>")
          print("  </order>")
 
        print('</orders>')    

    def export_tsv(self):
        for order in self._orders:
            print(f"{order.id}\t{order.customer.name}\t{order.customer.address}\t{len(order.ingredints)}")

    def export(self, format):
        if not format in ['xml', 'tsv']:
            raise('unsupported format')

        if format=='xml':
            self.export_xml()

        if format=='tsv':
          self.export_xml()    
```
